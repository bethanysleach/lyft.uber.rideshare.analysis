uber_lyft_rides_per_day_november$Date <- as.Date(uber_lyft_rides_per_day_november$datetime)
uber_lyft_rides_per_day_november$Time <- format(as.POSIXct(uber_lyft_rides_per_day_november$datetime), 
                                                format = "%H:%M:%S") 
unique(uber_lyft_rides_per_day_november$day)

begin_nov <- as.POSIXct("2018-11-26")
finish_nov <- as.POSIXct("2018-11-30")

dat3 <- data.frame(Date = seq.POSIXt(from = begin_nov, to = finish_nov, by ="DSTday"))

dat3$weekday1 <- as.numeric(format(dat3$Date, format = "%u"))
dat3$weekday2 <- format(dat3$Date, format = "%a")
dat3$weekday3 <- format(dat3$Date, format = "%A")

uber_lyft_november_merge_dates <- uber_lyft_rides_per_day_november %>%
        full_join(dat3, by="Date")

uber_lyft_november_merge_dates$weekday3 <- ordered(uber_lyft_november_merge_dates$weekday3, 
                                                   levels=c("Monday","Tuesday", "Wednesday", 
                                                            "Thursday", "Friday", "Saturday", "Sunday"))

uber_lyft_november_merge_dates <- uber_lyft_november_merge_dates %>%
        select(-datetime)
uber_lyft_november_merge_dates

uber_lyft_november_merge_dates <- uber_lyft_november_merge_dates %>%
        filter(source != "NA")
unique(uber_lyft_november_merge_dates)


ggplot(uber_lyft_november_merge_dates, aes(source, fill=weekday3)) + geom_bar(position="dodge") + 
        scale_y_continuous(labels=comma) + theme(axis.text.x = element_text(angle=90, vjust=.5, hjust=1)) + 
        ggtitle("Daily Number of Total Rides Per Station - November") + scale_fill_discrete(name = "Day of the Week") +
        xlab("Station") + ylab("Total Rides")

uber_lyft_november_merge_dates_imp_info<- uber_lyft_november_merge_dates %>%
        dplyr::group_by(Date, weekday1, weekday2, weekday3) %>%
        summarize(total_rides=n())
uber_lyft_november_merge_dates_imp_info
